Nom : ARRAYSOFARRAYS
Formule : 
LAMBDA(input_table,calculation_lambda,[byrow], LET(logic,IF( ROWS(input_table) = 0, "Input table is empty", LET( use_by_row_logic, IF(ISOMITTED(byrow), FALSE, byrow = 1), IF( use_by_row_logic, LET( row_indices, SEQUENCE(ROWS(input_table)), table_result, REDUCE("", row_indices, LAMBDA(table_acc,row_idx, LET( current_row, INDEX(input_table, row_idx, 0), row_result, REDUCE("", current_row, LAMBDA(row_acc,current_item, LET( processed_item, IF( OR(current_item = "", AND(ISNUMBER(current_item), current_item = 0)), "", IFERROR(calculation_lambda(current_item), "") ), HSTACK(row_acc, processed_item) ) )), VSTACK(table_acc, DROP(row_result, , 1)) ) )), DROP(table_result, 1) ), LET( col_indices, SEQUENCE(COLUMNS(input_table)), table_result, REDUCE("", col_indices, LAMBDA(table_acc,col_idx, LET( current_col, INDEX(input_table, 0, col_idx), col_result, REDUCE("", current_col, LAMBDA(col_acc,current_item, LET( processed_item, IF( OR(current_item = "", AND(ISNUMBER(current_item), current_item = 0)), "", IFERROR(calculation_lambda(current_item), "") ), VSTACK(col_acc, processed_item) ) )), HSTACK(table_acc, DROP(col_result, 1)) ) )), DROP(table_result, , 1) ) ) ) ),IFERROR(logic,"")) )
