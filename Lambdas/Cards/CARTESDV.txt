Nom : CARTESDV
Formule : 
LAMBDA(_Cartes,_Runs,_1Top2Bottom3Both,[_Boucle?],[_Suites], LET(    \\LambdaName, "CARTESDV",    _SuitesListe, ExtractCardsSuits(_Cartes),    _CleanCardsList, SUBSTITUTE(       SUBSTITUTE(CARDS_VALUE_LIST(_1Top2Bottom3Both), "U", ""),       "D",       ""    ),    _CardsList, CARDS_VALUE_LIST(_1Top2Bottom3Both),    _Values, ExtractCardsValue(_Cartes),    _RunsIndex, LET(       a, SEQUENCE(ROWS(_CardsList)) + SEQUENCE(, _Runs, 0),       b, IF(ISOMITTED(_Boucle?), a, MOD(a - 1, ROWS(_CardsList)) + 1),       b    ),    _CardsRuns, TOCOL(BYROW(INDEX(_CleanCardsList, _RunsIndex), CONCAT), 3),    _Step7, MAP(       _CardsRuns,       LAMBDA(a, LET(          b, REDUCE(             "",             Flate(a),             LAMBDA(x,y,                TOCOL(                   TOCOL(x) & "-"                      & TOROW(                         FILTER(                            _Cartes,                            (_Values = y)                               * IF(                                  ISOMITTED(_Suites),                                  1,                                  N(_SuitesListe = _Suites)                               ),                            "n/a"                         )                      )                )             )          ),          c, FILTER(MID(b, 2, 10), 1 - ISNUMBER(SEARCH("n/a", b)), "n/a"),          d, TEXTJOIN("|", , c),          d       ))    ),    _Out, FILTER(_Step7, _Step7 <> "n/a", "n/a"),    _Out&"" ))
